#!/usr/bin/env bash

INPUT_DIR=$1
OUTPUT_DIR=$2

# TO DO: check if this is even needed
VDI_IMPORT_ID=${VDI_IMPORT_ID-PLACEHOLDER_VDI_ID}

# TO DO: get category (e.g. phenotype, rnaseq, general (clinepi/popbio-like))
# from somewhere. Currently falling back to 'phenotype'.
CATEGORY=${CATEGORY-phenotype}

# TO DO: validate CATEGORY here or in the R-script
# ?

# change to a directory we can rely on
cd /opt/veupathdb

# include some utility functions
. lib/includes.sh

# Validate input and output directories
verifyAbsolute "${INPUT_DIR}"  || exit $EXIT_CODE_UNEXPECTED_ERROR
verifyAbsolute "${OUTPUT_DIR}" || exit $EXIT_CODE_UNEXPECTED_ERROR
verifyDir "${INPUT_DIR}"  || exit $EXIT_CODE_UNEXPECTED_ERROR
verifyDir "${OUTPUT_DIR}" || exit $EXIT_CODE_UNEXPECTED_ERROR

Rscript bin/wrangle.R $CATEGORY $INPUT_DIR $OUTPUT_DIR

